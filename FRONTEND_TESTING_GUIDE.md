# 🌐 Leafswap前端测试指南

## 📋 测试准备

### 网络配置
- **网络**: Sepolia测试网
- **Chain ID**: 11155111
- **RPC URL**: 使用MetaMask默认的Sepolia RPC

### 账户信息
- **Deployer地址**: `0xfb35053Bd39dD936f5B430DD5e73E0A6d9B02C85`
- **可用TKA**: 999,890 TKA
- **可用TKB**: 999,890 TKB

### 合约地址
- **TKA合约**: `0x198921c2Ca38Ee088cF65bFF5327249b1D23409e`
- **TKB合约**: `0x0eD732A13D4432EbF0937E5b0F6B64d3DA8F7627`
- **交易对**: `0x8592C7A1d83a99c6da64bf9582C81D402102079E`
- **流动性池**: 100 TKA + 100 TKB

---

## 🔧 前端测试设置

### 1. MetaMask配置
1. **切换到Sepolia网络**
   - 打开MetaMask
   - 点击网络选择器
   - 选择"Sepolia测试网"

2. **导入Deployer账户**
   - 点击账户图标
   - 选择"导入账户"
   - 输入私钥（从.env文件获取）

3. **添加代币到MetaMask**
   - 点击"导入代币"
   - 添加TKA代币：
     - 合约地址: `0x198921c2Ca38Ee088cF65bFF5327249b1D23409e`
     - 代币符号: TKA
     - 小数位数: 18
   - 添加TKB代币：
     - 合约地址: `0x0eD732A13D4432EbF0937E5b0F6B64d3DA8F7627`
     - 代币符号: TKB
     - 小数位数: 18

### 2. 前端访问
1. **启动前端服务器**
   ```bash
   cd frontend
   python3 -m http.server 8000
   ```

2. **访问前端**
   - 打开浏览器
   - 访问: `http://localhost:8000`

---

## 🧪 测试用例

### 测试1: 钱包连接
**目标**: 验证MetaMask连接功能

**步骤**:
1. 打开前端页面
2. 点击"连接钱包"按钮
3. 在MetaMask中确认连接

**预期结果**:
- ✅ 钱包连接成功
- ✅ 显示正确的账户地址
- ✅ 显示Sepolia网络信息

### 测试2: 代币余额显示
**目标**: 验证代币余额正确显示

**步骤**:
1. 连接钱包后
2. 检查TKA和TKB余额显示

**预期结果**:
- ✅ TKA余额显示: ~999,890
- ✅ TKB余额显示: ~999,890
- ✅ 余额格式正确

### 测试3: MEV保护开关
**目标**: 验证MEV保护功能

**步骤**:
1. 找到MEV保护开关
2. 切换开关状态
3. 检查状态变化

**预期结果**:
- ✅ 开关可以正常切换
- ✅ 状态正确保存
- ✅ 显示当前保护状态

### 测试4: 代币交换计算
**目标**: 验证交换计算功能

**步骤**:
1. 在交换界面输入TKA数量（如10）
2. 检查TKB输出数量计算
3. 验证滑点设置

**预期结果**:
- ✅ 输入10 TKA，输出约9.066 TKB
- ✅ 滑点保护正常工作
- ✅ 价格影响显示正确

### 测试5: 代币交换执行
**目标**: 验证实际交换功能

**步骤**:
1. 输入交换数量（建议1-5 TKA）
2. 设置滑点容忍度（如5%）
3. 点击"交换"按钮
4. 在MetaMask中确认交易

**预期结果**:
- ✅ 交易成功执行
- ✅ 收到正确的TKB数量
- ✅ 余额正确更新
- ✅ 交易哈希显示

### 测试6: 流动性管理
**目标**: 验证流动性添加功能

**步骤**:
1. 切换到流动性管理界面
2. 输入要添加的TKA和TKB数量（建议各10个）
3. 点击"添加流动性"
4. 在MetaMask中确认交易

**预期结果**:
- ✅ 流动性添加成功
- ✅ 收到LP代币
- ✅ 流动性池更新

### 测试7: 网络切换
**目标**: 验证网络切换功能

**步骤**:
1. 在MetaMask中切换到其他网络
2. 检查前端是否正确提示
3. 切换回Sepolia网络

**预期结果**:
- ✅ 网络切换检测正确
- ✅ 显示正确的网络信息
- ✅ 合约地址正确加载

---

## 📊 测试检查清单

### 基础功能
- [ ] 钱包连接正常
- [ ] 网络切换正常
- [ ] 代币余额显示正确
- [ ] 合约地址配置正确

### MEV保护功能
- [ ] MEV保护开关正常工作
- [ ] 保护状态正确显示
- [ ] 保护参数配置正确

### 交换功能
- [ ] 交换计算准确
- [ ] 滑点保护有效
- [ ] 交易执行成功
- [ ] 余额更新正确

### 流动性管理
- [ ] 流动性添加成功
- [ ] LP代币发放正确
- [ ] 流动性池状态更新

### 用户体验
- [ ] 界面响应流畅
- [ ] 错误提示清晰
- [ ] 加载状态显示
- [ ] 交易确认流程

---

## 🚨 常见问题解决

### 问题1: 钱包连接失败
**解决方案**:
- 确保MetaMask已安装并解锁
- 检查是否在Sepolia网络
- 刷新页面重试

### 问题2: 代币余额不显示
**解决方案**:
- 检查代币是否已添加到MetaMask
- 验证合约地址是否正确
- 刷新页面重试

### 问题3: 交易失败
**解决方案**:
- 检查账户余额是否充足
- 确保gas费用设置合理
- 检查滑点设置是否过小

### 问题4: 网络错误
**解决方案**:
- 确保MetaMask连接到Sepolia
- 检查RPC连接是否正常
- 尝试切换网络后重试

---

## 📈 性能测试

### 响应时间测试
- 页面加载时间: < 3秒
- 钱包连接时间: < 2秒
- 交易确认时间: < 30秒

### 并发测试
- 多个用户同时使用
- 快速连续操作
- 网络切换测试

### 错误处理测试
- 网络断开重连
- 交易失败处理
- 余额不足处理

---

## 🎯 测试完成标准

### 功能完整性
- ✅ 所有核心功能正常工作
- ✅ MEV保护机制有效
- ✅ 代币交换功能完整
- ✅ 流动性管理正常

### 用户体验
- ✅ 界面友好易用
- ✅ 操作流程顺畅
- ✅ 错误提示清晰
- ✅ 响应速度合理

### 安全性
- ✅ 交易确认机制
- ✅ 滑点保护有效
- ✅ 权限控制正确
- ✅ 数据验证完整

---

## 📞 技术支持

### 测试数据
- **测试账户**: `0xfb35053Bd39dD936f5B430DD5e73E0A6d9B02C85`
- **可用代币**: 999,890 TKA + 999,890 TKB
- **流动性池**: 100 TKA + 100 TKB

### 合约地址
- **Factory**: `0x2dABACdbDf93C247E681E3D7E124B61f311D6Fd9`
- **Router**: `0x7d02eD568a1FD8048dc4FDeD9895a40356A47782`
- **MEVGuard**: `0x1527Db198B15099A78209E904aDCcD762EC250E5`

### 测试脚本
- `scripts/check-token-distribution.js` - 检查代币分布
- `scripts/test-frontend-integration.js` - 前端集成测试

---

**指南创建时间**: 2025年8月18日  
**测试状态**: 准备就绪 ✅  
**项目状态**: 100%可用 🎉
